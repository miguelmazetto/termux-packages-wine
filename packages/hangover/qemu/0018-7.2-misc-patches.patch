diff -uNr qemu-orig/linux-user/mmap.c qemu/linux-user/mmap.c
--- qemu-orig/linux-user/mmap.c	2023-03-02 03:05:20.013611933 -0300
+++ qemu/linux-user/mmap.c	2023-03-02 03:05:20.563611770 -0300
@@ -29,6 +29,8 @@
 static pthread_mutex_t mmap_mutex = PTHREAD_MUTEX_INITIALIZER;
 static __thread int mmap_lock_count;
 
+typedef unsigned long ulong;
+
 void mmap_lock(void)
 {
     if (mmap_lock_count++ == 0) {
diff -uNr qemu-orig/linux-user/syscall.c qemu/linux-user/syscall.c
--- qemu-orig/linux-user/syscall.c	2023-03-02 03:05:20.013611933 -0300
+++ qemu/linux-user/syscall.c	2023-03-02 03:10:32.983610672 -0300
@@ -118,27 +118,6 @@
 #define FS_IOC32_GETVERSION            _IOR('v', 1, int)
 #define FS_IOC32_SETVERSION            _IOW('v', 2, int)
 
-#define BLKGETSIZE64 _IOR(0x12,114,size_t)
-#define BLKDISCARD _IO(0x12,119)
-#define BLKIOMIN _IO(0x12,120)
-#define BLKIOOPT _IO(0x12,121)
-#define BLKALIGNOFF _IO(0x12,122)
-#define BLKPBSZGET _IO(0x12,123)
-#define BLKDISCARDZEROES _IO(0x12,124)
-#define BLKSECDISCARD _IO(0x12,125)
-#define BLKROTATIONAL _IO(0x12,126)
-#define BLKZEROOUT _IO(0x12,127)
-
-#define FIBMAP     _IO(0x00,1)
-#define FIGETBSZ   _IO(0x00,2)
-
-struct file_clone_range {
-        __s64 src_fd;
-        __u64 src_offset;
-        __u64 src_length;
-        __u64 dest_offset;
-};
-
 #define FICLONE         _IOW(0x94, 9, int)
 #define FICLONERANGE    _IOW(0x94, 13, struct file_clone_range)
 
Binary files qemu-orig/scripts/qapi/__pycache__/__init__.cpython-310.pyc and qemu/scripts/qapi/__pycache__/__init__.cpython-310.pyc differ
Binary files qemu-orig/scripts/qapi/__pycache__/commands.cpython-310.pyc and qemu/scripts/qapi/__pycache__/commands.cpython-310.pyc differ
Binary files qemu-orig/scripts/qapi/__pycache__/common.cpython-310.pyc and qemu/scripts/qapi/__pycache__/common.cpython-310.pyc differ
Binary files qemu-orig/scripts/qapi/__pycache__/error.cpython-310.pyc and qemu/scripts/qapi/__pycache__/error.cpython-310.pyc differ
Binary files qemu-orig/scripts/qapi/__pycache__/events.cpython-310.pyc and qemu/scripts/qapi/__pycache__/events.cpython-310.pyc differ
Binary files qemu-orig/scripts/qapi/__pycache__/expr.cpython-310.pyc and qemu/scripts/qapi/__pycache__/expr.cpython-310.pyc differ
Binary files qemu-orig/scripts/qapi/__pycache__/gen.cpython-310.pyc and qemu/scripts/qapi/__pycache__/gen.cpython-310.pyc differ
Binary files qemu-orig/scripts/qapi/__pycache__/introspect.cpython-310.pyc and qemu/scripts/qapi/__pycache__/introspect.cpython-310.pyc differ
Binary files qemu-orig/scripts/qapi/__pycache__/main.cpython-310.pyc and qemu/scripts/qapi/__pycache__/main.cpython-310.pyc differ
Binary files qemu-orig/scripts/qapi/__pycache__/parser.cpython-310.pyc and qemu/scripts/qapi/__pycache__/parser.cpython-310.pyc differ
Binary files qemu-orig/scripts/qapi/__pycache__/schema.cpython-310.pyc and qemu/scripts/qapi/__pycache__/schema.cpython-310.pyc differ
Binary files qemu-orig/scripts/qapi/__pycache__/source.cpython-310.pyc and qemu/scripts/qapi/__pycache__/source.cpython-310.pyc differ
Binary files qemu-orig/scripts/qapi/__pycache__/types.cpython-310.pyc and qemu/scripts/qapi/__pycache__/types.cpython-310.pyc differ
Binary files qemu-orig/scripts/qapi/__pycache__/visit.cpython-310.pyc and qemu/scripts/qapi/__pycache__/visit.cpython-310.pyc differ
Binary files qemu-orig/scripts/tracetool/__pycache__/__init__.cpython-310.pyc and qemu/scripts/tracetool/__pycache__/__init__.cpython-310.pyc differ
Binary files qemu-orig/scripts/tracetool/__pycache__/transform.cpython-310.pyc and qemu/scripts/tracetool/__pycache__/transform.cpython-310.pyc differ
Binary files qemu-orig/scripts/tracetool/__pycache__/vcpu.cpython-310.pyc and qemu/scripts/tracetool/__pycache__/vcpu.cpython-310.pyc differ
Binary files qemu-orig/scripts/tracetool/backend/__pycache__/__init__.cpython-310.pyc and qemu/scripts/tracetool/backend/__pycache__/__init__.cpython-310.pyc differ
Binary files qemu-orig/scripts/tracetool/backend/__pycache__/dtrace.cpython-310.pyc and qemu/scripts/tracetool/backend/__pycache__/dtrace.cpython-310.pyc differ
Binary files qemu-orig/scripts/tracetool/format/__pycache__/__init__.cpython-310.pyc and qemu/scripts/tracetool/format/__pycache__/__init__.cpython-310.pyc differ
Binary files qemu-orig/scripts/tracetool/format/__pycache__/c.cpython-310.pyc and qemu/scripts/tracetool/format/__pycache__/c.cpython-310.pyc differ
Binary files qemu-orig/scripts/tracetool/format/__pycache__/h.cpython-310.pyc and qemu/scripts/tracetool/format/__pycache__/h.cpython-310.pyc differ
diff -uNr qemu-orig/subprojects/libvhost-user/libvhost-user.c qemu/subprojects/libvhost-user/libvhost-user.c
--- qemu-orig/subprojects/libvhost-user/libvhost-user.c	2023-03-02 03:05:20.563611770 -0300
+++ qemu/subprojects/libvhost-user/libvhost-user.c	2023-03-02 03:05:20.563611770 -0300
@@ -163,6 +163,20 @@
     }
 }
 
+static inline int vring_need_event(__u16 event_idx, __u16 new_idx, __u16 old)
+{
+    return (__u16)(new_idx - event_idx - 1) < (__u16)(new_idx - old);
+}
+
+static int memfd_create(const char *uname, unsigned int flag)
+{
+#ifdef SYS_memfd_create
+    return syscall(SYS_memfd_create, uname, flag);
+#else
+    return -ENOSYS;
+#endif
+}
+
 static void G_GNUC_PRINTF(2, 3)
 vu_panic(VuDev *dev, const char *msg, ...)
 {
diff -uNr qemu-orig/subprojects/libvhost-user/libvhost-user.h qemu/subprojects/libvhost-user/libvhost-user.h
--- qemu-orig/subprojects/libvhost-user/libvhost-user.h	2023-03-02 03:05:20.563611770 -0300
+++ qemu/subprojects/libvhost-user/libvhost-user.h	2023-03-02 03:05:20.573611767 -0300
@@ -20,7 +20,7 @@
 #include <poll.h>
 #include <linux/vhost.h>
 #include <pthread.h>
-#include "standard-headers/linux/virtio_ring.h"
+//#include "standard-headers/linux/virtio_ring.h"
 
 /* Based on qemu/hw/virtio/vhost-user.c */
 #define VHOST_USER_F_PROTOCOL_FEATURES 30
